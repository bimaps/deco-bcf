"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.BcfProjectController = void 0;
const deco_api_1 = require("deco-api");
const bcf_export_controller_1 = require("./bcf.export.controller");
const bcf_project_1 = require("../models/bcf.project");
const bcf_core_controller_1 = require("./bcf.core.controller");
const express_1 = require("express");
let debug = require('debug')('app:controller:bcf:project');
const router = (0, express_1.Router)();
let projectController = new bcf_core_controller_1.BcfCoreControllerMiddleware(bcf_project_1.BcfProjectModel);
let exportController = new bcf_export_controller_1.BcfExportController();
router.use(projectController.registerPolicyMountingPoint(['bcf.project']));
router.get(deco_api_1.ControllerMiddleware.getAllRoute(), deco_api_1.AppMiddleware.fetchWithPublicKey, bcf_core_controller_1.BcfCoreControllerMiddleware.authenticate, projectController.registerPolicyMountingPoint(['bcf.project.get']), projectController.prepareQueryFromReq(), projectController.getAll());
router.get(deco_api_1.ControllerMiddleware.getOneRoute(), deco_api_1.AppMiddleware.fetchWithPublicKey, bcf_core_controller_1.BcfCoreControllerMiddleware.authenticate, projectController.registerPolicyMountingPoint(['bcf.project.get']), projectController.getOne());
router.post(deco_api_1.ControllerMiddleware.postRoute(), deco_api_1.AppMiddleware.fetchWithPublicKey, bcf_core_controller_1.BcfCoreControllerMiddleware.authenticate, projectController.registerPolicyMountingPoint(['bcf.project.write', 'bcf.project.post']), projectController.prepareAuthorBody(), projectController.post());
router.put(deco_api_1.ControllerMiddleware.putRoute(), deco_api_1.AppMiddleware.fetchWithPublicKey, bcf_core_controller_1.BcfCoreControllerMiddleware.authenticate, projectController.checkProjectAuthorization('update'), projectController.registerPolicyMountingPoint(['bcf.project.write', 'bcf.project.put']), projectController.prepareAuthorBody(), projectController.put());
router.get(deco_api_1.ControllerMiddleware.getOneRoute() + '/extensions', deco_api_1.AppMiddleware.fetchWithPublicKey, bcf_core_controller_1.BcfCoreControllerMiddleware.authenticate, projectController.registerPolicyMountingPoint(['bcf.project.get']), projectController.getOne({ ignoreSend: true, ignoreDownload: true, ignoreOutput: true }), projectController.returnProjectExtensions);
router.get(deco_api_1.ControllerMiddleware.getOneRoute() + '/export-file', deco_api_1.AppMiddleware.fetchWithPublicKey, bcf_core_controller_1.BcfCoreControllerMiddleware.authenticate, projectController.registerPolicyMountingPoint(['bcf.project.export']), projectController.getOne({ ignoreSend: true, ignoreDownload: true, ignoreOutput: true }), exportController.generateBcfFile());
router.delete(deco_api_1.ControllerMiddleware.deleteRoute(), deco_api_1.AppMiddleware.fetchWithPublicKey, bcf_core_controller_1.BcfCoreControllerMiddleware.authenticate, projectController.registerPolicyMountingPoint(['bcf.project.write', 'bcf.project.delete']), projectController.checkProjectAuthorization('update'), projectController.delete());
exports.BcfProjectController = router;
//# sourceMappingURL=bcf.project.controller.js.map